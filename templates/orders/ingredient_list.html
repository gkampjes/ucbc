{% extends "base.html" %}
{% load currency %}

{% block container %}
{#<div class="row">#}
{#  {% block cart %}#}
{#  <div class="col-md-12">#}
{#    <p>My Order: 0 items, total: $0.00</p>#}
{#  </div>#}
{#  {% endblock %}#}
{#</div>#}


<div class="row">
  <div class="col-md-8">
    {% block ingredients %}
    <h3>{{ title }}</h3>
    <form method="post" action="">{% csrf_token %}
    {{ formset.management_form }}
      <table class="table">
        <thead>
          <tr class="row">
            <th class="col-md-7">Name</th>
            <th class="col-md-4">Cost (NZD) Excl. GST</th>
            <th class="col-md-1"></th>
          </tr>
        </thead>
        <tbody>
          {% for form in formset %}
          <tr class="row">
            <td class="col-md-7">{{ form.ingredient.name }}</td>
            <td class="col-md-4">{{ form.ingredient.unit_cost|currency }} per {{ form.ingredient.unit_size }}</td>
            <td class="col-md-1">
              {{ form.quantity.errors }}
              {{ form.quantity }}
            </td>
          </tr>
          {% endfor %}
          <tr class="row">
            <td class="col-md-7"/>
            <td class="col-md-4">
            </td>
            <td class="col-md-1">
              <button type="submit" class="btn btn-default btn-sm">Add</button>
            </td>
          </tr>
        </tbody>
        </table>
      </form>
    {% endblock %}
  </div>

  {% block cart %}
  <div class="col-md-4">
    <form method="post" action="{% url 'orders.views.cart' %}">{% csrf_token %}
      <h3>My Order</h3>

      <table class="table">
      <thead>
        <tr class="row">
          <th class="col-sm-8">Name</th>
          <th class="col-sm-2">Quantity</th>
          <th class="col-sm-2"/>
        </tr>
      </thead>
      <tbody>
        {% for ingredient_name, quantity in request.session.cart.items %}
        <tr class="row">
          <td class="col-sm-8"><input type="hidden" name="ingredient_name" value="{{ ingredient_name }}">{{ ingredient_name }}</td>
          <td class="col-sm-2"><input type="hidden" name="quantity" value="{{ quantity }}">{{ quantity }}</td>
          <td class="col-sm-2"><button type="submit" formaction="{% url 'orders.views.cart_delete_item' %}" class="btn btn-default btn-sm">X</button></td>
        </tr>
        {% endfor %}
        <tr class="row">
          <td/>
          <td><button type="submit" class="btn btn-default btn-sm">Checkout</button></td>
          <td/>
        </tr>
      </tbody>
      </table>

    </form>
  </div>
  {% endblock %}

</div>
{% endblock %}